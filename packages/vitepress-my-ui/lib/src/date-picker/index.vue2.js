"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const D=require("../utils/utils.js"),c=require("vue"),y=c.defineComponent({name:"DatePicker",emits:["update:modelValue","clear","change"],props:{modelValue:{type:Array,default:()=>[]},initFormat:{type:String,default:""},startPlaceholder:{type:String,default:"开始日期"},endPlaceholder:{type:String,default:"结束日期"},selectTime:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0}},setup(l,{emit:d}){const{globalProperties:n}=D.useCurrentInstance();let e=c.reactive({dateType:l.selectTime?"datetimerange":"daterange",value:"",datePickerRef:c.ref(null),classKey:"daterange",format:""});const i=[{text:"时间范围",value:()=>{a("daterange"),o(null),setTimeout(()=>{e.datePickerRef.focus(!0)},0)}},{text:"指定日之前",value:()=>{a("dateBefore"),o(null),setTimeout(()=>{e.datePickerRef.focus(!0)},0)}},{text:"指定日之后",value:()=>{a("dateAfter"),o(null),setTimeout(()=>{e.datePickerRef.focus(!0)},0)}},{text:"当日之前",value:()=>{a("nowDateBefore"),o(s(Date(),"YYYY-MM-DD 23:59:59"))}},{text:"当日之后",value:()=>{a("nowDateAfter"),o(s(Date(),"YYYY-MM-DD 00:00:00"))}}];let f=c.computed(()=>l.selectTime?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD").value;const a=t=>{const r=l.selectTime?"datetime":"date";switch(t){case"daterange":e.dateType=l.selectTime?"datetimerange":"daterange",e.format="";break;case"dateBefore":case"nowDateBefore":e.dateType=r,e.format=`~ 至 ${f}`;break;case"dateAfter":case"nowDateAfter":e.dateType=r,e.format=`${f} 至 ~`;break}e.classKey=t},s=(t,r)=>t?n.dayjs(t).format(r||l.initFormat||f):"",o=t=>{if(!t){["dateBefore","dateAfter"].includes(e.classKey)?d("update:modelValue",["","",e.classKey]):d("update:modelValue",["","","daterange"]),d("clear",t);return}let r=[];switch(e.classKey){case"daterange":r=[s(t[0]),s(t[1]),e.classKey];break;case"dateBefore":case"nowDateBefore":r=["",s(t),e.classKey];break;case"dateAfter":case"nowDateAfter":r=[s(t),"",e.classKey];break}d("update:modelValue",r)};c.watch(()=>l.modelValue,t=>{if(t&&t.length>0)if(t[2])switch(a(t[2]),t[2]){case"daterange":e.value=[t[0],t[1]];break;case"dateBefore":e.value=t[1];break;case"dateAfter":e.value=t[0];break;case"nowDateBefore":e.value=s(Date(),"YYYY-MM-DD 23:59:59");break;case"nowDateAfter":e.value=s(Date(),"YYYY-MM-DD 00:00:00");break}else t[0]&&t[1]?(a("daterange"),e.value=t):t[0]?(a("dateAfter"),e.value=t[0]):t[1]&&(a("dateBefore"),e.value=t[1]);else a("daterange"),e.value="";d("change",e.value)},{deep:!0,immediate:!0});const u=t=>{l.selectTime&&(t?["dateBefore","dateAfter","nowDateBefore","nowDateAfter"].includes(e.classKey)&&(e.format=""):(["dateBefore","nowDateBefore"].includes(e.classKey)&&(e.format=`~ 至 ${f}`),["dateAfter","nowDateAfter"].includes(e.classKey)&&(e.format=`${f} 至 ~`)))},m=t=>["nowDateBefore","nowDateAfter"].includes(e.classKey);return{...c.toRefs(e),shortcuts:i,onChange:o,visibleChange:u,disabledDate:m}}});exports.default=y;
